/*
formBuilder - http://kevinchappell.github.io/formBuilder/
Version: 1.8.1
Author: Kevin Chappell <kevin.b.chappell@gmail.com>
*/
"use strict";!function(e){var t=function(t,a){var l={theme:"fresh",labels:{off:"Off",on:"On"}},s=e.extend(l,a),i=e('<div class="kc-toggle"/>').insertAfter(t).append(t);i.toggleClass("on",t.is(":checked"));var o='<div class="kct-on">'+s.labels.on+"</div>",n='<div class="kct-off">'+s.labels.off+"</div>",r='<div class="kct-handle"></div>',c='<div class="kct-inner">'+o+r+n+"</div>";i.append(c),i.click(function(){t.attr("checked",!t.attr("checked")),e(this).toggleClass("on")})};e.fn.kcToggle=function(a){var l=this;return l.each(function(){var l=e(this);if(!l.data("kcToggle")){var s=new t(l,a);l.data("kcToggle",s)}})}}(jQuery),function(e){var t=function(t,a){var l={disableFields:{},defaultFields:[],roles:{1:"Administrator"},showWarning:!1,serializePrefix:"frmb",messages:{add:"Add Item",allowSelect:"Allow Select",autocomplete:"Autocomplete",button:"Button",cannotBeEmpty:"This field cannot be empty",checkboxGroup:"Checkbox Group",checkbox:"Checkbox",checkboxes:"Checkboxes",clearAllMessage:"Are you sure you want to remove all items?",clearAll:"Clear All",close:"Close",copy:"Copy To Clipboard",dateField:"Date Field",description:"Help Text",descriptionField:"Description",devMode:"Developer Mode",disableFields:"These fields cannot be moved.",editNames:"Edit Names",editorTitle:"Form Elements",editXML:"Edit XML",fieldVars:"Field Variables",fieldRemoveWarning:"Are you sure you want to remove this field?",fileUpload:"File Upload",getStarted:"Drag a field from the right to this area",hide:"Edit",hidden:"Hidden Input",label:"Label",labelEmpty:"Field Label cannot be empty",limitRole:"Limit access to one or more of the following roles:",mandatory:"Mandatory",maxlength:"Max Length",minOptionMessage:"This field requires a minimum of 2 options",name:"Name",no:"No",off:"Off",on:"On",optional:"optional",optionLabelPlaceholder:"Label",optionValuePlaceholder:"Value",optionEmpty:"Option value required",paragraph:"Paragraph",placeholder:"Placeholder",placeholders:{text:"",textarea:"",email:"Enter you email",password:"Enter your password"},preview:"Preview",radioGroup:"Radio Group",radio:"Radio",removeMessage:"Remove Element",remove:"&#215;",required:"Required",richText:"Rich Text Editor",roles:"Access",save:"Save Template",selectOptions:"Select Items",select:"Select",selectColor:"Select Color",selectionsMessage:"Allow Multiple Selections",size:"Size",sizes:{xs:"Extra Small",sm:"Small",m:"Default",lg:"Large"},style:"Style",styles:{btn:{"default":"Default",danger:"Danger",info:"Info",primary:"Primary",success:"Success",warning:"Warning"}},subtype:"Type",subtypes:{text:["text","password","email","color"],button:["button","submit"]},text:"Text Field",textArea:"Text Area",toggle:"Toggle",warning:"Warning!",viewXML:"View XML",yes:"Yes"}};l.messages.subtypes.password=l.messages.subtypes.text,l.messages.subtypes.email=l.messages.subtypes.text,l.messages.subtypes.color=l.messages.subtypes.text,l.messages.subtypes.submit=l.messages.subtypes.button;var s,i=!1,o={};o.attrString=function(e){var t=[];for(var a in e)e.hasOwnProperty(a)&&(a=o.safeAttr(a,e[a]),t.push(a.name+a.value));return t.join(" ")},o.hyphenCase=function(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})},o.safeAttr=function(e,t){var a={className:"class"};return e=a[e]||o.hyphenCase(e),t=window.JSON.stringify(t),t=t?"="+t:"",{name:e,value:t}},o.mobileClass=function(){var e="";return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=" fb-mobile")}(navigator.userAgent||navigator.vendor||window.opera),e},o.startMoving=function(t,a){t=t,a.item.addClass("moving"),s=e("li",this).index(a.item)},o.stopMoving=function(t,a){t=t,a.item.removeClass("moving"),i?(e(a.sender).sortable("cancel"),e(this).sortable("cancel")):o.save()},o.safename=function(e){return e.replace(/\s/g,"-").replace(/[^a-zA-Z0-9\-]/g,"").toLowerCase()},o.forceNumber=function(e){return e.replace(/[^0-9]/g,"")},o.initTooltip=function(e){var t=e.find(".tooltip");e.mouseenter(function(){t.outerWidth()>200&&t.addClass("max-width"),t.css("left",e.width()+14),t.stop(!0,!0).fadeIn("fast")}).mouseleave(function(){e.find(".tooltip").stop(!0,!0).fadeOut("fast")}),t.hide()},o.save=function(){M.children("li").not(".disabled").each(function(){o.updatePreview(e(this))}),r.val(M.toXML()),r.trigger("change")},o.updatePreview=function(t){var a=t.attr("class");if(-1===a.indexOf("ui-sortable-handle")){var l,s=e(".prev-holder",t),i=e(".fld-subtype",t).val();a=a.replace("-field form-field",""),l=i?i:a;var n,r={type:l,label:e(".fld-label",t).val()},c=e(".fld-maxlength",t);c&&(r.maxlength=c.val());var d=e(".fld-placeholder",t).val();d&&(r.placeholder=d);var p=e(".btn-style",t).val();p&&(r.style=p),"checkbox"===a&&(r.toggle=e(".checkbox-toggle",t).is(":checked")),a.match(/(select|checkbox-group|radio-group)/)&&(r.values=[],r.multiple=e('[name="multiple"]',t).is(":checked"),e(".sortable-options li",t).each(function(){var t={};t.selected=e(".select-option",e(this)).is(":checked"),t.value=e(".option-value",e(this)).val(),t.label=e(".option-label",e(this)).val(),r.values.push(t)})),r.className=o.className(r.type,r.className,r.style),t.data("fieldData",r),n=V(r),s.html(n),e("input[toggle]",s).kcToggle()}},o.updateMultipleSelect=function(){M.delegate('input[name="multiple"]',"change",function(){var t=e(this).parents(".fields:eq(0)").find(".sortable-options input.select-option");this.checked?t.each(function(){e(this).prop("type","checkbox")}):t.each(function(){e(this).removeAttr("checked").prop("type","radio")})})},o.htmlEncode=function(t){return e("<div/>").text(t).html()},o.htmlDecode=function(t){return e("<div/>").html(t).text()},o.validateForm=function(){var t=[];e('input[name="label"], input[type="text"].option',M).each(function(){if(""===e(this).val()){var a=e(this).parents("li.form-field"),l=e(this);t.push({field:a,error:n.messages.labelEmpty,attribute:l})}}),t.length&&(alert("Error: "+t[0].error),e("html, body").animate({scrollTop:t[0].field.offset().top},1e3,function(){var a=e(".toggle-form",t[0].field).attr("id");e(".toggle-form",t[0].field).addClass("open").parent().next(".prev-holder").slideUp(250),e("#"+a+"-fld").slideDown(250,function(){t[0].attribute.addClass("error")})}))},o.disabledTT=function(t){var a=t.attr("data-tooltip");if(a){t.removeAttr("title").data("tip_text",a);var l=e("<p/>",{"class":"frmb-tt"}).html(a);t.append(l),l.css({top:-l.outerHeight(),left:-15}),t.mouseleave(function(){e(this).attr("data-tooltip",t.data("tip_text")),e(".frmb-tt").remove()})}},o.className=function(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],a=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],l=[],s={button:"btn",submit:"btn"},i=s[e];return t&&l.push(t),i?(l.push(i),a&&l.push(i+"-"+a)):"checkbox"!==e&&l.push("form-control"),l.join(" ")},o.markup=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=arguments.length<=2||void 0===arguments[2]?"":arguments[2];t=o.attrString(t),a=Array.isArray(a)?a.join(""):a;var l=["input"],s=-1===l.indexOf(e)?"<"+e+" "+t+">"+a+"</"+e+">":"<"+e+" "+t+"/>";return s};for(var n=e.extend(!0,l,a),r=e(t),c="frmb-"+e("ul[id^=frmb-]").length++,d="",p=1,m=c+"-control-box",u=[{label:n.messages.text,attrs:{type:"text",className:"text-input",name:"text-input"}},{label:n.messages.select,attrs:{type:"select",className:"select",name:"select"}},{label:n.messages.textArea,attrs:{type:"textarea",className:"rich-text",name:"rich-text"}},{label:n.messages.radioGroup,attrs:{type:"radio-group",className:"radio-group",name:"radio-group"}},{label:n.messages.hidden,attrs:{type:"hidden",className:"hidden-input",name:"hidden-input"}},{label:n.messages.fileUpload,attrs:{type:"file",className:"file-input",name:"file-input"}},{label:n.messages.dateField,attrs:{type:"date",className:"calendar",name:"date-input"}},{label:n.messages.checkboxGroup,attrs:{type:"checkbox-group",className:"checkbox-group",name:"checkbox-group"}},{label:n.messages.checkbox,attrs:{type:"checkbox",className:"checkbox",name:"checkbox"}},{label:n.messages.button,attrs:{type:"button",className:"button-input",name:"button"}},{label:n.messages.autocomplete,attrs:{type:"autocomplete",className:"autocomplete",name:"autocomplete"}}],f=e("<ul/>",{id:m,"class":"frmb-control"}),v=u.length-1;v>=0;v--){var g=e("<li/>",{"class":"icon-"+u[v].attrs.className,type:u[v].type,name:u[v].className,label:u[v].label});for(var h in u[v])u[v].hasOwnProperty(h)&&g.data(h,u[v][h]);g.html(u[v].label).appendTo(f)}var b=e("<h4/>").html(n.messages.editorTitle),y=e("<a/>",{id:c+"-export-xml",text:n.messages.viewXML,href:"#","class":"view-xml"}),k=e("<a/>",{id:c+"-allow-select",text:n.messages.allowSelect,href:"#","class":"allow-select"}).prop("checked","checked"),x=e("<button/>",{id:c+"-edit-xml",text:n.messages.editXML,href:"#","class":"edit-xml btn btn-default"}),w=e("<a/>",{id:c+"-edit-names",text:n.messages.editNames,href:"#","class":"edit-names"}),C=e("<a/>",{id:c+"-clear-all",text:n.messages.clearAll,href:"#","class":"clear-all"}),T=e("<div/>",{id:c+"-save",href:"#","class":"save-btn-wrap",title:n.messages.save}).html('<a class="save fb-button primary"><span>'+n.messages.save+"</span></a>"),_=e("<div/>",{id:c+"-action-links-inner","class":"action-links-inner"}).append(T,x," | ",w," | ",k," | ",C," |&nbsp;"),E=e("<span/>",{"class":"dev-mode-link"}).html(n.messages.devMode+" "+n.messages.off),N=e("<div/>",{id:c+"-action-links","class":"action-links"}).append(_,E),M=e("<ul/>").attr("id",c).addClass("frmb").sortable({cursor:"move",opacity:.9,beforeStop:function(t,a){t=t;var l=e("> li",M).length-1,s=a.placeholder.index();i=n.disableFields.before?1>=s:n.disableFields.after?s===l:!1},start:o.startMoving,stop:o.stopMoving,cancel:"input, select, .disabled, .frm-fld, .btn",placeholder:"frmb-placeholder"});f.sortable({helper:"clone",opacity:.9,connectWith:M,cursor:"move",placeholder:"ui-state-highlight",start:o.startMoving,stop:o.stopMoving,revert:150,remove:function(t,a){t=t,0===s?f.prepend(a.item):e("li:nth-child("+s+")",f).after(a.item)},beforeStop:function(e,t){e=e,t.placeholder.parent().hasClass("frmb-control")&&(i=!0)},update:function(t,a){t=t,r.stopIndex=0===e("li",M).index(a.item)?"0":e("li",M).index(a.item),e("li",M).index(a.item)<0?e(this).sortable("cancel"):D(e(a.item[0]),!0)},receive:function(t,a){t=t,(a.sender.hasClass("frmb")||a.sender.hasClass("frmb-control"))&&e(a.sender).sortable("cancel")}});var q=e("<div/>",{id:c+"-stage-wrap","class":"stage-wrap"}),A=e("<div/>",{id:c+"-form-wrap","class":"form-wrap form-builder"+o.mobileClass()});r.before(q).appendTo(q);var O=e("<div/>",{id:c+"-cb-wrap","class":"cb-wrap"}).append(b,f);q.append(M,O,y,N),q.before(A),A.append(q,O);var S=function(){if(0===e(this).parents("li.disabled").length){if("label"===e(this).name&&""===e(this).val())return alert("Error: "+n.messages.labelEmpty);o.save()}};e("input, select",M).on("change",S),e("input, select",M).on("blur",S),r.getTemplate=function(){var t=""!==r.val()?e.parseXML(r.val()):!1,a=e(t).find("field");if(a.length>0)a.each(function(){D(e(this))});else if(!t){if(n.defaultFields.length){n.defaultFields.reverse();for(var l=n.defaultFields.length-1;l>=0;l--)P(n.defaultFields[l])}else q.addClass("empty").attr("data-content",n.messages.getStarted);F()}};var F=function(){var t='<li class="disabled __POSITION__">__CONTENT__</li>';n.disableFields.before&&!e(".disabled.before",M).length&&M.prepend(t.replace("__POSITION__","before").replace("__CONTENT__",n.disableFields.before)),n.disableFields.after&&!e(".disabled.after",M).length&&M.append(t.replace("__POSITION__","after").replace("__CONTENT__",n.disableFields.after))},z=function(e){var t=(new Date).getTime();return e.data("attrs").name+"-"+t},D=function(t,a){a=a||!1;var l=t.data("attrs")||{},s=l.type||t.attr("type"),i=s.match(/(select|checkbox-group|radio-group)/),n={};n.label=o.htmlEncode(t.attr("label")),n.name=a?z(t):l.name||t.attr("name"),n.role=t.attr("role"),n.required=t.attr("required"),n.maxlength=t.attr("maxlength"),n.toggle=t.attr("toggle"),n.multiple=t.attr("multiple"),n.type=s,n.description=void 0!==t.attr("description")?o.htmlEncode(t.attr("description")):"",i&&("checkbox-group"===n.type&&(n.multiple=!0),n.values=[],t.children().each(function(){var t={label:e(this).text(),value:e(this).attr("value"),selected:Boolean(e(this).attr("selected"))};n.values.push(t)})),P(n),q.removeClass("empty"),F()},I=function(e){G(n.messages.textArea,B(e),e)},j=function(e){var t=e.type||"text";G(n.messages[t],B(e),e)},L=function(t){t.values&&t.values.length||(t.values=[{selected:!0,label:"Option 1",value:"option-1"},{selected:!1,label:"Option 2",value:"option-2"}]);var a="",l=o.safename(t.name);for(a+=B(t),a+='<div class="false-label">'+n.messages.selectOptions+"</div>",a+='<div class="fields">',"select"===t.type&&(a+='<div class="allow-multi">',a+='<input type="checkbox" id="multiple_'+p+'" name="multiple"'+(t.multiple?'checked="checked"':"")+">",a+='<label class="multiple" for="multiple_'+p+'">'+n.messages.selectionsMessage+"</label>",a+="</div>"),a+='<ol class="sortable-options">',v=0;v<t.values.length;v++)a+=H(t.values[v],l,t.values[v].selected,t.multiple);a+="</ol>",a+='<div class="field_actions"><a href="javascript: void(0);" class="add add_opt"><strong>'+n.messages.add+'</strong></a> | <a href="javascript: void(0);" class="close-field">'+n.messages.close+"</a></div>",a+="</div>",G(n.messages.select,a,t),e(".sortable-options").sortable()},P=function(e){var t={select:L,"rich-text":I,textarea:I,"radio-group":L,"checkbox-group":L};e=e||"",t[e.type]?t[e.type](e):j(e)},B=function Y(t){var a,Y="",l=void 0!==t.role?t.role.split(","):[],s=e("<div>",{"class":"frm-fld label-wrap"});if(e("<label/>").text(n.messages.label).appendTo(s),e("<input>",{type:"text",name:"label",value:t.label,"class":"fld-label form-control"}).appendTo(s),Y+=s[0].outerHTML,t.size=t.size||"m",t.style=t.style||"default","button"!==t.type){var i=o.markup("label",{},n.messages.description),r=o.markup("input",{type:"text",className:"fld-description form-control",name:"description",id:"description-"+p,value:t.description},n.messages.description),c=o.markup("div",{"class":"frm-fld description-wrap"},[i,r]);Y+=c}Y+=R(t.type),Y+=X(t.size,t.type),Y+=W(t.style,t.type),Y+=U(t.type),Y+='<div class="frm-fld name-wrap"><label>'+n.messages.name+' <span class="required">*</span></label>',Y+='<input type="text" name="name" value="'+t.name+'" class="fld-name form-control" id="title-'+p+'" /></div>',Y+='<div class="frm-fld access-wrap"><label>'+n.messages.roles+"</label>",Y+='<input type="checkbox" name="enable_roles" value="" '+(void 0!==t.role?"checked":"")+' id="enable_roles-'+p+'"/> <label for="enable_roles-'+p+'" class="roles-label">'+n.messages.limitRole+"</label>",Y+='<div class="frm-fld available-roles" '+(void 0!==t.role?'style="display:block"':"")+">";for(a in n.roles)-1===e.inArray(a,["date","4"])&&(Y+='<input type="checkbox" name="roles[]" value="'+a+'" id="fld-'+p+"-roles-"+a+'" '+(-1!==e.inArray(a,l)?"checked":"")+' class="roles-field" /><label for="fld-'+p+"-roles-"+a+'">'+n.roles[a]+"</label><br/>");return Y+="</div></div>",e.inArray(t.type,["checkbox","select","checkbox-group","date","autocomplete","radio-group","hidden","button"])<0&&(Y+='<div class="frm-fld"><label class="maxlength-label">'+n.messages.maxlength+"</label>",Y+='<input type="text" name="maxlength" maxlength="4" value="'+(void 0!==t.maxlength?t.maxlength:"")+'" class="fld-maxlength form-control" id="maxlength-'+p+'" /></div>'),Y},R=function(e){var t=n.messages.subtypes,a="";if(t[e]){var l="<label>"+n.messages.subtype+"</label>";a+='<select name="subtype" class="fld-subtype form-control" id="subtype-'+p+'">',t[e].forEach(function(t){var l=e===t?"selected":"";a+='<option value="'+t+'" '+l+">"+t+"</option>"}),a+="</select>",a='<div class="frm-fld subtype-wrap">'+l+" "+a+"</div>"}return a},X=function K(e,t){var a=Object.keys(n.messages.sizes),l={button:"btn",text:"input"},K="";if(l[t]){var s="<label>"+n.messages.size+"</label>";K+='<select name="size" class="fld-size form-control" id="size-'+p+'">',a.forEach(function(a){var s=e===a?"selected":"";K+='<option value="'+l[t]+"-"+a+'" '+s+">"+n.messages.sizes[a]+"</option>"}),K+="</select>",K='<div class="frm-fld size-wrap">'+s+" "+K+"</div>"}return K},W=function(e,t){var a={button:"btn"},l=n.messages.styles[a[t]],s="";if(l){var i="<label>"+n.messages.style+"</label>";s+='<input value="'+e+'" name="style" type="hidden" class="btn-style">',s+='<div class="btn-group" role="group">',Object.keys(n.messages.styles[a[t]]).forEach(function(l){var i=e===l?"active":"";s+='<button value="'+l+'" type="'+t+'" class="'+i+" btn-xs "+a[t]+" "+a[t]+"-"+l+'">'+n.messages.styles[a[t]][l]+"</button>"}),s+="</div>",s='<div class="frm-fld style-wrap">'+i+" "+s+"</div>"}return s},U=function(e){var t=n.messages.placeholders,a="";if("undefined"!=typeof t[e]){var l="<label>"+n.messages.placeholder+"</label>";a+='<input type="text" name="placeholder" placeholder="'+t[e]+'" class="fld-placeholder form-control" id="placeholder-'+p+'">',a='<div class="frm-fld placeholder-wrap">'+l+" "+a+"</div>"}return a},G=function(t,a,l){var s=e(a).find('input[name="label"]').val(),i=s?s:t,c='<a id="del_'+p+'" class="del-button btn delete-confirm" href="javascript: void(0);" title="'+n.messages.removeMessage+'">'+n.messages.remove+"</a>",d='<a id="frm-'+p+'" class="toggle-form btn icon-pencil" href="javascript: void(0);" title="'+n.messages.hide+'"></a> ',m=l.required,u=l.toggle||void 0,f=""!==l.description?'<span class="tooltip-element" tooltip="'+l.description+'">?</span>':"",v='<div class="legend">';v+=c,v+='<label class="field-label">'+i+"</label>"+f+'<span class="required-asterisk" '+("true"===m?'style="display:inline"':"")+"> *</span>"+d,v+="</div>",v+='<div class="prev-holder">'+V(l)+"</div>",v+='<div id="frm-'+p+'-fld" class="frm-holder">',v+='<div class="form-elements">',v+='<div class="frm-fld">',v+="<label>&nbsp;</label>",v+='<input class="required" type="checkbox" value="1" name="required-'+p+'" id="required-'+p+'"'+("true"===m?' checked="checked"':"")+' /><label class="required-label" for="required-'+p+'">'+n.messages.required+"</label>","checkbox"===l.type&&(v+='<div class="frm-fld">',v+="<label>&nbsp;</label>",v+='<input class="checkbox-toggle" type="checkbox" value="1" name="toggle-'+p+'" id="toggle-'+p+'"'+("true"===u?' checked="checked"':"")+' /><label class="toggle-label" for="toggle-'+p+'">'+n.messages.toggle+"</label>",v+="</div>"),v+="</div>",v+=a,v+="</div>",v+="</div>";var g=o.markup("li",{"class":l.type+"-field form-field",id:"frm-"+p+"-item"},v),h=e(g);h.data("fieldData",{attrs:l}),r.stopIndex?e("li",M).eq(r.stopIndex).after(h):M.append(h),e(document.getElementById("frm-"+p+"-item")).hide().slideDown(250),p++,o.save()},V=function(e){var t,a="",l=(new Date).getTime(),s=e.toggle?"toggle":"",i=o.attrString(e);switch(e.type){case"textarea":case"rich-text":a="<textarea "+i+"></textarea>";break;case"button":case"submit":a="<button "+i+">"+e.label+"</button>";break;case"select":var r=void 0,c=e.multiple?"multiple":"";for(e.values.reverse(),t=e.values.length-1;t>=0;t--){var d=e.values[t].selected?"selected":"";r+='<option value="'+e.values[t].value+'" '+d+">"+e.values[t].label+"</option>"}a="<"+e.type+' class="form-control" '+c+">"+r+"</"+e.type+">";break;case"checkbox-group":case"radio-group":var p=e.type.replace("-group","");for(e.values.reverse(),t=e.values.length-1;t>=0;t--){var m=e.values[t].selected?"checked":"";a+='<div><input type="'+p+'" id="'+p+"-"+l+"-"+t+'" value="'+e.values[t].value+'" '+m+'/><label for="'+p+"-"+l+"-"+t+'">'+e.values[t].label+"</label></div>"}break;case"text":case"password":case"email":case"date":case"file":a="<input "+i+">";break;case"color":a='<input type="'+e.type+'" class="form-control"> '+n.messages.selectColor;break;case"hidden":case"checkbox":a='<input type="'+e.type+'" '+s+" >";break;case"autocomplete":a='<input class="ui-autocomplete-input form-control" autocomplete="on">';break;default:a="<"+e.type+"></"+e.type+">"}return a},H=function(e,t,a,l){var s=l?"checkbox":"radio";return"object"!=typeof e?e={label:"",value:"",selected:!1}:(e.label=e.label||"",e.value=e.value||"",e.selected=e.selected||!1),a=e.selected?"checked":"",d="<li>",d+='<input type="'+s+'" '+a+' class="select-option" name="'+t+'" />',d+='<input type="text" class="option-label" placeholder="'+n.messages.optionLabelPlaceholder+'" value="'+e.label+'" />',d+='<input type="text" class="option-value" placeholder="'+n.messages.optionValuePlaceholder+'" value="'+e.value+'" />',d+='<a href="javascript: void(0);" class="remove btn" title="'+n.messages.removeMessage+'">'+n.messages.remove+"</a>",d+="</li>"};M.on("click touchstart",".remove",function(t){t.preventDefault();var a=e(this).parents(".sortable-options:eq(0)").children("li").length;2>=a?alert("Error: "+n.messages.minOptionMessage):e(this).parent("li").slideUp("250",function(){e(this).remove()})}),M.on("touchstart","input",function(t){if(t.handled===!0)return!1;if("checkbox"===e(this).attr("type"))e(this).trigger("click");else{e(this).focus();var a=e(this).val();e(this).val(a)}}),M.on("click touchstart",".toggle-form",function(t){if(t.stopPropagation(),t.preventDefault(),t.handled===!0)return!1;var a=e(this).attr("id");o.toggleEdit(a+"-item"),t.handled=!0}),o.toggleEdit=function(t){var a=document.getElementById(t),l=e(".toggle-form",a),s=e(".frm-holder",a);l.toggleClass("open").parent().next(".prev-holder").slideToggle(250),s.slideToggle(250,function(){o.save()})},M.on("keyup change",'input[name="label"]',function(){e(".field-label",e(this).closest("li")).text(e(this).val())}),M.delegate("input.error","keyup",function(){e(this).removeClass("error")}),M.delegate('input[name="description"]',"keyup",function(){var t=e(".tooltip-element",e(this).closest("li"));if(""!==e(this).val())if(t.length)t.attr("tooltip",e(this).val()).css("display","inline-block");else{var a='<span class="tooltip-element" tooltip="'+e(this).val()+'">?</span>';e(".toggle-form",e(this).closest("li")).before(a)}else t.length&&t.css("display","none")}),o.updateMultipleSelect(),M.delegate('input[name="name"]',"keyup",function(){e(this).val(o.safename(e(this).val())),""===e(this).val()?e(this).addClass("field_error").attr("placeholder",n.messages.cannotBeEmpty):e(this).removeClass("field_error")}),M.delegate("input.fld-maxlength","keyup",function(){e(this).val(o.forceNumber(e(this).val()))}),M.on("click touchstart",".delete-confirm",function(t){t.preventDefault();var a=e("<h3/>").html("<span></span>"+n.messages.warning),l=e(this).attr("id").replace(/del_/,""),s=e(this),i=e(document.getElementById("frm-"+l+"-item")),r=s.offset().left-e(window).scrollLeft(),c=s.offset().top-e(window).scrollTop();n.showWarning?jQuery("<div />").append(a,n.messages.fieldRemoveWarning).dialog({modal:!0,resizable:!1,width:300,dialogClass:"ite-warning",open:function(){e(".ui-widget-overlay").css({opacity:0})},position:[r-282,c-178],buttons:[{text:n.messages.yes,click:function(){i.slideUp(250,function(){e(this).remove(),o.save()}),e(this).dialog("close")}},{text:n.messages.no,"class":"cancel",click:function(){e(this).dialog("close")}}]}):i.slideUp(250,function(){e(this).remove(),o.save()}),1===e(".form-field",M).length&&q.addClass("empty")}),M.on("click",".style-wrap button",function(){var t=e(this).val(),a=e(this).parent();a.siblings(".btn-style").val(t),e(this).siblings(".btn").removeClass("active"),e(this).addClass("active")}),M.on("click","input.required",function(){var t=e(this).parents("li.form-field").find(".required-asterisk");t.toggle()}),M.on("click",'input[name="enable_roles"]',function(){var t=e(this).siblings("div.available-roles"),a=e(this);t.slideToggle(250,function(){a.is(":checked")||e('input[type="checkbox"]',t).removeAttr("checked")})}),M.on("click",".add_ck",function(){return e(this).parent().before(H()),!1}),M.on("mouseenter","li.disabled .form-element",function(){o.disabledTT(e(this))}),M.on("click",".add_opt",function(t){t.preventDefault();var a=e(this).parents(".fields:eq(0)"),l=e('[name="multiple"]',a),s=e(".select-option:eq(0)",a),i=s.attr("name"),n=!1;n=l.length?l.prop("checked"):"checkbox"===s.attr("type"),e(".sortable-options",a).append(H(!1,i,!1,n)),o.updateMultipleSelect()}),M.on("click touchstart",".close-field",function(){var t=e(this).parents("li.form-field:eq(0)").attr("id");o.toggleEdit(t)}),M.on("click",".add_rd",function(t){t.preventDefault(),e(this).parent().before(H(!1,e(this).parents(".frm-holder").attr("id")))}),e(".form-elements .fields .remove, .frmb .del-button").on("hover",function(){e(this).parents("li.form-field").toggleClass("delete")}),e(document.getElementById(c+"-export-xml")).click(function(t){t.preventDefault();var a=r.val(),l=e("<pre />").text(a);l.dialog({resizable:!1,modal:!0,width:720,dialogClass:"frmb-xml",overlay:{color:"#333333"}})}),e(document.getElementById(c+"-clear-all")).click(function(e){if(e.preventDefault(),window.confirm(n.messages.clearAllMessage)){M.empty(),r.val(""),o.save();var t={label:[n.messages.descriptionField],name:["content"],required:"true",description:n.messages.mandatory};P(t),M.prepend(n.disableFields.before),M.append(n.disableFields.after)}}),e(document.getElementById(c+"-save")).click(function(t){0===e(this).find(".ldkInlineEdit").length&&(t.preventDefault(),q.hasClass("edit-xml")||o.save(),o.validateForm(t))});var Q=!1,Z=[],J="68,69,86";e(".save.fb-button").mouseover(function(){Q=!0}).mouseout(function(){Q=!1}),e(document.documentElement).keydown(function(t){Z.push(t.keyCode),Z.toString().indexOf(J)>=0&&(e(".action-links").toggle(),e(".view-xml").toggle(),Z=[])}),e(".dev-mode-link").click(function(t){t.preventDefault();var a=e(this);q.toggleClass("dev-mode"),a.parent().css("opacity",1),q.hasClass("dev-mode")?(a.siblings(".action-links-inner").css("width","100%"),a.html(n.messages.devMode+" "+n.messages.on).css("color","#8CC63F")):(a.siblings(".action-links-inner").css("width",0),a.html(n.messages.devMode+" "+n.messages.off).css("color","#666666"),Q=!1,e(".action-links").toggle(),e(".view-xml").toggle())}),e(document.getElementById(c+"-edit-names")).click(function(t){t.preventDefault(),e(this).toggleClass("active"),e(".name-wrap",M).slideToggle(250,function(){q.toggleClass("edit-names")})}),e(document.getElementById(c+"-allow-select")).click(function(t){t.preventDefault(),e(this).toggleClass("active"),e(".allow-multi, .select-option",M).slideToggle(250,function(){q.toggleClass("allow-select")})}),e(document.getElementById(c+"-edit-xml")).click(function(t){t.preventDefault(),e(this).toggleClass("active"),e("textarea.idea-template").show(),e(".template-textarea-wrap").slideToggle(250),q.toggleClass("edit-xml")}),r.parent().find('p[id*="ideaTemplate"]').remove(),r.wrap('<div class="template-textarea-wrap"/>'),r.getTemplate(),M.css("min-height",f.height())};e.fn.formBuilder=function(a){var l=this;return l.each(function(){var s,i=e(this);if(i.data("formBuilder")){var o=i.parents(".form-builder:eq(0)"),n=i.clone();o.before(n),o.remove(),s=new t(n,a),n.data("formBuilder",s)}else s=new t(l,a),i.data("formBuilder",s)})}}(jQuery),function(e){e.fn.toXML=function(t){var a={prepend:"",attributes:["class"]},l=e.extend(a,t),s="",i={};i.getType=function(t){var a=e(".fld-subtype",t).val()||t.attr("class").replace("-field form-field","");return a},i.getClassName=function(t){var a=e(".fld-class",t).val()||t.data("fieldData").className||"";return a},i.hyphenCase=function(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})},i.attrString=function(e){var t=[];for(var a in e)if(e.hasOwnProperty(a)&&e[a]){var l=a+'="'+e[a]+'"';t.push(l)}return t.join(" ")};var o=function(t){var a=[];return e(".sortable-options li",t).each(function(){var t=e(this),l='value="'+e(".option-value",t).val()+'"',s=e(".option-label",t).val(),i=e(".select-option",t).is(":checked")?' selected="true"':"";a.push("\n			<option"+i+" "+l+">"+s+"</option>")}),a.join("")};return this.each(function(){e(this).children().length>=1&&(s+="<form-template>\n	<fields>",e(this).children().each(function(){var t=e(this);if(!t.hasClass("moving")&&!t.hasClass("disabled"))for(var a=0;a<l.attributes.length;a++){var n=e.map(e("input.roles-field:checked",t),function(e){return e.value}).join(","),r={className:i.getClassName(t),description:e("input.fld-description",t).val(),label:e("input.fld-label",t).val(),maxlength:e("input.fld-maxlength",t).val(),multiple:e('input[name="multiple"]',t).is(":checked"),name:e("input.fld-name",t).val(),placeholder:e("input.fld-placeholder",t).val(),required:e("input.required",t).is(":checked"),role:n,toggle:e(".checkbox-toggle",t).is(":checked"),type:i.getType(t)},c=r.type.match(/(select|checkbox-group|radio-group)/),d=i.attrString(r),p=c?"":"/";s+="\n		<field "+d+p+">",c&&(s+=o(t),s+="\n		</field>")}}),s+="\n	</fields>\n</form-template>")}),s}}(jQuery);